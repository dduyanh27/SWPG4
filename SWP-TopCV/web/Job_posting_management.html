<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jobs Admin - Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-dark-1: #031428;   /* Very dark left */
      --bg-dark-2: #062446;   /* Mid */
      --bg-bright:  #0a67ff;  /* Bright right */
      --card-dark:  rgba(6,24,44,0.85);
      --card-light: rgba(255,255,255,0.02);
      --muted: rgba(255,255,255,0.75);
      --muted-2: rgba(255,255,255,0.6);
      --primary:#2f80ed;
      --danger:#ff5a6b;
      --radius:10px;
      --shadow: 0 10px 30px rgba(2,10,30,0.6);
    }

.user {
  display: none;
}

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(110deg, var(--bg-dark-1) 0%, var(--bg-dark-2) 40%, #083d9a 70%, var(--bg-bright) 100%);
      color: var(--muted);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      font-size:14px;
      min-height:100vh;
      position:relative;
      overflow-x:hidden;
    }

    /* faint spotlight on right like screenshot */
    body::after{
      content:"";
      position:fixed;
      right:-20%;
      top:0;
      width:45%;
      height:100%;
      background: radial-gradient(circle at left center, rgba(10,103,255,0.08), transparent 35%);
      pointer-events:none;
    }

    /* Layout */
    .app{
      display:flex;
      min-height:100vh;
    }
    /* Sidebar */
    .sidebar{
      width:280px;
      background: linear-gradient(180deg, rgba(3,18,40,0.98), rgba(6,24,44,0.98));
      border-right:1px solid rgba(255,255,255,0.03);
      padding:22px 14px;
      display:flex;
      flex-direction:column;
      gap:12px;
      color: #e6f6ff;
    }
    .brand{
      font-weight:700;
      font-size:18px;
      color:#e6f6ff;
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .nav{
      margin-top:10px;
      display:flex;flex-direction:column;gap:6px;
    }
    .nav a{
      display:block;
      padding:10px 12px;
      border-radius:6px;
      color:rgba(255,255,255,0.85);
      text-decoration:none;
      font-weight:500;
    }
    .nav a.active, .nav a:hover{
      background: rgba(255,255,255,0.03);
      color: #ffffff;
    }

    /* Main area */
    .main{
      flex:1;
      display:flex;
      flex-direction:column;
      min-width:0;
    }
    .topbar{
      height:64px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 20px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      
      
      color: var(--muted);
    }
    .top-left{display:flex;gap:12px;align-items:center}
    .page-title {
      font-weight: 600;
      color: #ffffff;
      font-size: 28px;
      margin-bottom: -50px;
    }
    .user{color:var(--muted-2);font-weight:600}

    /* Content */
    .content{
      padding:28px;
      max-width:1200px;
      margin:0 auto;
      width:100%;
    }

    .card{
      background: linear-gradient(180deg, var(--card-dark), rgba(6,24,44,0.6));
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
      border:1px solid rgba(255,255,255,0.03);
      color: #eaf4ff;
    }

    .card .card-title{
      font-size:16px;font-weight:600;color:#f8fcff;margin-bottom:12px;
    }

    /* Table */
    .table-wrap{
      overflow-x:auto;
    }
    table{
      width:100%;
      border-collapse:collapse;
      min-width:900px;
      font-size:13px;
      color: #eaf4ff;
    }
    thead th{
      text-align:left;
      padding:14px 12px;
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.75);
      font-weight:600;
      border-bottom:1px solid rgba(255,255,255,0.04);
      vertical-align:middle;
    }
    tbody td{
      padding:14px 12px;
      border-bottom:1px solid rgba(255,255,255,0.02);
      vertical-align:middle;
      color:#eaf4ff;
    }
    tbody tr:hover{background: rgba(255,255,255,0.01)}
    .id-col{width:48px;color:rgba(255,255,255,0.6);font-weight:600}
    .job-title{font-weight:600;color:#ffffff}
    .muted{color:var(--muted-2);font-size:13px}
    .center{text-align:center}

    /* buttons */
    .btn{
      display:inline-block;
      padding:8px 12px;
      border-radius:6px;
      font-weight:600;
      font-size:13px;
      cursor:pointer;
      border:0;
      box-shadow: 0 6px 16px rgba(2,10,30,0.45);
    }
    .btn.confirm{background:linear-gradient(90deg,var(--primary),#0b63ff);color:#fff}
    .btn.danger{background:linear-gradient(90deg,#ff5a6b,#e74c3c);color:#fff}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--primary)}

    /* status */
    .status{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      font-weight:600;
      font-size:12px;
    }
    .status.ok{background: rgba(0,255,150,0.06);color:#bff7d6}
    .status.pending{background: rgba(255,215,90,0.06);color:#ffe8a6}

    /* Responsive */
    @media (max-width:900px){
      .sidebar{display:none}
      .content{padding:14px}
      table{min-width:700px}
    }

    /* Ensure selects/options readable if you add any later */
    select, input[type="text"]{color:#21323b}
    select option{color:#21323b}
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar" role="navigation">
      <div class="brand">
        JOBs
      </div>

      <nav class="nav" aria-label="Main">
        <a href="admin-dashboard.html">Bảng thống kê</a>
        <a class="active" href="#">Tin tuyển dụng</a>
        <a href="Admin-user.html">Quản lý tài khoản</a>
        <a href="#">Quản lý danh mục</a>
        <a href="#">Đơn xin việc</a>
        <a href="#">Tin tuyển dụng</a>
      </nav>
    </aside>

    <div class="main">
      <header class="topbar">
        <div class="top-left">
          <div class="page-title">Quản lý tin tuyển dụng</div>
        </div>

        <div class="user">Admin</div>
      </header>

      <main class="content">
        <div class="card">
          <div class="card-title">Danh sách tin tuyển dụng</div>

          <div class="table-wrap">
            <!-- Aggregated table: Nhà tuyển dụng | Danh mục | Số tin còn hoạt động -->
            <table aria-label="Danh sách nhà tuyển dụng">
              <thead>
                <tr>
                  <th>Nhà tuyển dụng</th>
                  <th>Danh mục</th>
                  <th class="center">Số tin còn hoạt động</th>
                </tr>
              </thead>
              <tbody id="employers-table"></tbody>
            </table>
          </div>

          <!-- Modal to show active jobs for an employer -->
          <div id="jobsModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;z-index:9999">
            <div style="background:var(--card-dark);padding:18px;border-radius:10px;max-width:900px;width:90%;color:#eaf4ff;box-shadow:var(--shadow);">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                <div style="font-weight:700">Tin đang hoạt động</div>
                <button onclick="closeJobsModal()" style="background:transparent;border:0;color:var(--muted);font-weight:700;cursor:pointer">Đóng ✕</button>
              </div>
              <div id="modalJobsList" style="max-height:60vh;overflow:auto"></div>
            </div>
          </div>

        </div>
      </main>
    </div>
  </div>

  <script>
    // Example jobs dataset (expand / replace with real data)
    const jobs = [
      {id:62, title:'Luật sư', employer:'Công ty GRAB', category:'Bán lẻ / bán sỉ', status:'ok', start:'2025-03-01', end:'2025-09-01'},
      {id:52, title:'Nonfarm Animal Caretaker', employer:'Công ty GRAB', category:'An toàn lao động', status:'ok', start:'2024-07-09', end:'2025-07-09'},
      {id:53, title:'Jewelry Model', employer:'Công ty GRAB', category:'Bán hàng kỹ thuật', status:'pending', start:'2024-09-01', end:'2025-03-01'},
      {id:54, title:'Fiber Product Cutting Operator', employer:'Công ty A', category:'Sản xuất', status:'ok', start:'2024-08-01', end:'2025-02-01'},
      {id:55, title:'Pharmacist', employer:'Công ty A', category:'Y tế', status:'ok', start:'2024-06-01', end:'2024-12-01'},
      {id:56, title:'Digital Marketer', employer:'Công ty B', category:'Marketing', status:'ok', start:'2025-01-10', end:'2025-07-10'},
      {id:57, title:'Frontend Developer', employer:'Công ty B', category:'Công nghệ', status:'pending', start:'2024-11-01', end:'2025-05-01'}
    ];

    // Aggregate jobs by employer -> collect categories and count active jobs (status === 'ok')
    function aggregateByEmployer(items){
      const map = new Map();
      items.forEach(j=>{
        const key = j.employer || 'Khác';
        if(!map.has(key)) map.set(key, {employer:key, categories:new Set(), activeCount:0, activeJobs:[]});
        const rec = map.get(key);
        if(j.category) rec.categories.add(j.category);
        if(j.status === 'ok'){ rec.activeCount++; rec.activeJobs.push(j); }
      });
      return Array.from(map.values());
    }

    // Render employers table
    function renderEmployersTable(){
      const rows = aggregateByEmployer(jobs);
      const tbody = document.getElementById('employers-table');
      tbody.innerHTML = '';
      rows.forEach(r=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><a href="#" class="employer-link" data-employer="${escapeHtml(r.employer)}">${escapeHtml(r.employer)}</a></td>
          <td>${escapeHtml(Array.from(r.categories).join(', '))}</td>
          <td class="center">${r.activeCount}</td>
        `;
        tbody.appendChild(tr);
      });
      // attach click handlers
      tbody.querySelectorAll('.employer-link').forEach(a=>{
        a.addEventListener('click', (ev)=>{
          ev.preventDefault();
          const name = a.getAttribute('data-employer');
          showActiveJobsForEmployer(name);
        });
      });
    }

    function showActiveJobsForEmployer(name){
      const rec = aggregateByEmployer(jobs).find(r=>r.employer === name);
      const listEl = document.getElementById('modalJobsList');
      listEl.innerHTML = '';
      if(!rec || rec.activeJobs.length === 0){
        listEl.innerHTML = '<div>Không có tin tuyển dụng đang hoạt động.</div>';
      } else {
        const ul = document.createElement('ul');
        ul.style.paddingLeft = '18px';
        rec.activeJobs.forEach(j=>{
          const li = document.createElement('li');
          li.style.marginBottom = '8px';
          li.innerHTML = `<strong>${escapeHtml(j.title)}</strong> — <span class="muted">${escapeHtml(j.category)}</span> — <span class="muted">${escapeHtml(j.start)} → ${escapeHtml(j.end)}</span>`;
          ul.appendChild(li);
        });
        listEl.appendChild(ul);
      }
      document.getElementById('jobsModal').style.display = 'flex';
    }

    function closeJobsModal(){
      document.getElementById('jobsModal').style.display = 'none';
    }

    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, function(c){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c];}); }

    // initial render
    renderEmployersTable();
   </script>
 </body>
 </html>
