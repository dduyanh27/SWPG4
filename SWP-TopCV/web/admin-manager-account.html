<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin - Quản lý tài khoản</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-dark-1: #031428;
      --bg-dark-2: #062446;
      --bg-bright: #0a67ff;
      --card:#071a3a;
      --muted:rgba(255,255,255,0.75);
      --muted-2:rgba(255,255,255,0.6);
      --accent: rgba(255,255,255,0.03);
      --danger:#ff5a6b;
      --primary:#2f80ed;
      --radius:10px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,Arial;
      background: linear-gradient(110deg, var(--bg-dark-1) 0%, var(--bg-dark-2) 40%, #083d9a 70%, var(--bg-bright) 100%);
      color:var(--muted);
    }

    /* status badge */
    .status{display:inline-block;padding:6px 10px;border-radius:8px;font-weight:700;font-size:13px}
    .status.active{background: rgba(0,255,150,0.06);color:#bff7d6}
    .status.inactive{background: rgba(255,90,107,0.06);color:#ffd6da}
    .col-pass{width:260px} /* tăng để chứa nút */
    .col-date{width:130px}
    .col-status{width:140px;text-align:center}
    .col-act{width:100px;text-align:center}

    .wrap{display:flex;min-height:100vh}

    /* sidebar */
    .sidebar{width:280px;background:linear-gradient(180deg, rgba(2,10,30,0.95), rgba(3,18,40,0.95));border-right:1px solid rgba(255,255,255,0.03);padding:18px}
    .brand{font-weight:700;color:#dbefff;margin-bottom:12px}
    .nav{display:flex;flex-direction:column;gap:6px}
    .nav a{padding:8px 10px;border-radius:6px;color:rgba(255,255,255,0.85);text-decoration:none;font-weight:600}
    .nav a.active{background:rgba(255,255,255,0.03);color:#fff}

    /* main */
    .main{flex:1;display:flex;flex-direction:column}
    .topbar{height:64px;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:0 20px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .topbar .title{font-weight:700;color:#eaf4ff}

    .container{padding:20px;max-width:1100px;margin:0 auto;width:100%}

    /* card changed to dark */
    .card{
      background: linear-gradient(180deg, var(--card-dark), rgba(6,24,44,0.6));
      border-radius:12px;
      padding:14px;
      border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 10px 30px rgba(2,10,30,0.6);
      color: #eaf4ff;
    }

    .toolbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:12px}
    .left-tools{display:flex;align-items:center;gap:12px}
    .right-tools{display:flex;align-items:center;gap:8px}

    select, input[type="text"]{padding:8px 10px;border-radius:8px;border:1px solid #d7e1e6;background:#fff;color:#21323b}
    /* make dropdown options readable across browsers */
    select option{background:#fff;color:#21323b}
    input[type="text"]{min-width:180px}

    /* table */
    .table-wrap{overflow-x:auto}
    table{width:100%;border-collapse:collapse;font-size:14px;color:var(--muted)}
    thead th{background:rgba(255,255,255,0.03);padding:12px;text-align:left;color:var(--muted-2);font-weight:700;border-bottom:1px solid rgba(255,255,255,0.04)}
    tbody td{padding:12px;border-bottom:1px solid rgba(255,255,255,0.02);color:rgba(255,255,255,0.9)}
    tbody tr:hover{background:rgba(255,255,255,0.01)}

    .col-id{width:48px}
    .col-act{width:120px;text-align:center}
    .btn{padding:8px 12px;border-radius:8px;border:0;font-weight:700;cursor:pointer}
    .btn.delete{background:var(--danger);color:#fff}

    /* toggle password button */
    .btn.toggle{padding:6px 8px;margin-left:8px;border-radius:8px;background:rgba(255,255,255,0.04);color:var(--muted);font-weight:600}
    .pwd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; letter-spacing:1px}

    /* footer / pagination */
    .table-footer{display:flex;justify-content:space-between;align-items:center;padding-top:12px;color:var(--muted-2)}
    .pagination{display:flex;gap:6px;align-items:center}
    .pbtn{padding:6px 10px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:var(--muted);cursor:pointer}
    .pbtn.active{background:linear-gradient(90deg,var(--primary),#0b63ff);color:#fff;border-color:transparent}

    /* responsive */
    @media (max-width:900px){.sidebar{display:none}.container{padding:12px} .col-pass{width:200px}}
  </style>
</head>
<body>
  <div class="wrap">
    <aside class="sidebar">
      <div class="brand">JOBs</div>
      <nav class="nav">
        <a href="Job_posting_management.html">Tin tuyển dụng</a>
        <a class="active" href="#">Quản lý tài khoản</a>
        <a href="#">Quản lý danh mục</a>
        <a href="#">Đơn xin việc</a>
        <a href="#">Tin tuyển dụng</a>
      </nav>
    </aside>

    <main class="main">
      <header class="topbar">
        <div class="title">Quản lý tài khoản</div>
        <div class="user">Admin</div>
      </header>

      <section class="container">
        <div class="card">
          <div class="toolbar">
            <div class="left-tools">
              <label>Show
                <select id="rowsPerPage">
                  <option value="5">5</option>
                  <option value="10" selected>10</option>
                  <option value="25">25</option>
                </select>
              entries</label>
            </div>

            <div class="right-tools">
              <input type="text" id="searchInput" placeholder="Search..." />
            </div>
          </div>

          <div class="table-wrap">
            <table aria-label="Danh sách tài khoản">
              <thead>
                <tr>
                  <th class="col-id">Id</th>
                  <th>Email</th>
                  <th class="col-pass">Mật khẩu</th>
                  <th class="col-date">Kích hoạt</th>
                  <th class="col-date">Hết hạn</th>
                  <th class="col-status">Trạng thái</th>
                  <th class="col-act">Hành động</th>
                </tr>
              </thead>
              <tbody id="tableBody"></tbody>
            </table>
          </div>

          <div class="table-footer">
            <div id="infoText">Showing 0 to 0 of 0 entries</div>
            <div class="pagination" id="pagination"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Sample data for admin-provided employer accounts
    const data = [
      {id:1,email:'tua@gmail.com',password:'Pass@123',activation:'2025-08-01',end:'2026-08-01',status:'active'},
      {id:2,email:'momo@gmail.com',password:'Momo!234',activation:'2025-07-10',end:'2026-07-10',status:'active'},
      {id:3,email:'phuong@gmail.com',password:'Phuong321',activation:'2025-06-15',end:'2026-06-15',status:'inactive'},
      {id:4,email:'mobileone@gmail.com',password:'Mobile#1',activation:'2025-09-01',end:'2026-09-01',status:'active'},
      {id:5,email:'linhword@gmail.com',password:'LinhPwd5',activation:'2025-05-01',end:'2026-05-01',status:'inactive'},
    ];

    // State
    let filtered = [...data];
    let currentPage = 1;
    let rowsPerPage = parseInt(document.getElementById('rowsPerPage').value,10);

    const tableBody = document.getElementById('tableBody');
    const pagination = document.getElementById('pagination');
    const infoText = document.getElementById('infoText');

    function renderTable(){
      tableBody.innerHTML = '';
      const start = (currentPage-1)*rowsPerPage;
      const pageItems = filtered.slice(start, start+rowsPerPage);

      for(const row of pageItems){
        const tr = document.createElement('tr');
        const encodedPwd = encodeURIComponent(row.password || '');
        tr.innerHTML = `
          <td class="col-id">${row.id}</td>
          <td>${escapeHtml(row.email)}</td>
          <td class="col-pass">
            <span class="pwd" data-clear="${encodedPwd}">${escapeHtml(maskPassword(row.password))}</span>
            <button type="button" class="btn toggle" data-shown="0" onclick="togglePassword(this)">Hiển thị</button>
          </td>
          <td class="col-date">${formatDate(row.activation)}</td>
          <td class="col-date">${formatDate(row.end)}</td>
          <td class="col-status">${renderStatusBadge(row.status, row.id)}</td>
          <td class="col-act"><button class="btn delete" onclick="deleteRow(${row.id})">Xóa</button></td>
        `;
        tableBody.appendChild(tr);
      }

      const showingFrom = filtered.length===0?0:start+1;
      const showingTo = Math.min(start+pageItems.length, filtered.length);
      infoText.textContent = `Showing ${showingFrom} to ${showingTo} of ${filtered.length} entries`;
      renderPagination();
    }

    function renderPagination(){
      pagination.innerHTML = '';
      const totalPages = Math.ceil(filtered.length/rowsPerPage) || 1;

      const prev = document.createElement('button');
      prev.className = 'pbtn'; prev.textContent = 'Previous';
      prev.disabled = currentPage===1;
      prev.onclick = ()=>{ if(currentPage>1){currentPage--; renderTable();} };
      pagination.appendChild(prev);

      // show up to 5 pages
      const startPage = Math.max(1, currentPage-2);
      const endPage = Math.min(totalPages, startPage+4);

      for(let p=startPage;p<=endPage;p++){
        const b = document.createElement('button'); b.className = 'pbtn'+(p===currentPage?' active':''); b.textContent = p; b.onclick = ()=>{currentPage=p; renderTable();};
        pagination.appendChild(b);
      }

      const next = document.createElement('button');
      next.className = 'pbtn'; next.textContent = 'Next';
      next.disabled = currentPage===totalPages;
      next.onclick = ()=>{ if(currentPage<totalPages){currentPage++; renderTable();} };
      pagination.appendChild(next);
    }

    // search
    document.getElementById('searchInput').addEventListener('input', (e)=>{
      const q = e.target.value.trim().toLowerCase();
      filtered = data.filter(d=>
        String(d.id).includes(q) ||
        (d.email && d.email.toLowerCase().includes(q)) ||
        (d.status && d.status.toLowerCase().includes(q))
      );
      currentPage = 1; renderTable();
    });

    // rows per page
    document.getElementById('rowsPerPage').addEventListener('change', (e)=>{
      rowsPerPage = parseInt(e.target.value,10); currentPage=1; renderTable();
    });

    function deleteRow(id){
      if(!confirm('Bạn có chắc muốn xóa bản ghi id='+id+' ?')) return;
      const idx = data.findIndex(d=>d.id===id);
      if(idx>-1) data.splice(idx,1);
      filtered = filtered.filter(d=>d.id!==id);
      // adjust page if needed
      const totalPages = Math.ceil(filtered.length/rowsPerPage)||1;
      if(currentPage>totalPages) currentPage = totalPages;
      renderTable();
    }

    // toggle password visibility (per-row)
    function togglePassword(btn){
      const span = btn.parentElement.querySelector('.pwd');
      if(!span) return;
      const shown = btn.getAttribute('data-shown') === '1';
      const clear = decodeURIComponent(span.getAttribute('data-clear') || '');
      if(shown){
        span.textContent = maskPassword(clear);
        btn.textContent = 'Hiển thị';
        btn.setAttribute('data-shown','0');
      } else {
        span.textContent = clear;
        btn.textContent = 'Ẩn';
        btn.setAttribute('data-shown','1');
      }
    }

    function maskPassword(p){
      if(!p) return '';
      return p.replace(/./g,'*');
    }

    // toggle status: cho phép chuyển giữa 'active' <-> 'inactive'
    function toggleStatus(id){
      const item = data.find(d=>d.id===id);
      if(!item) return;
      const next = item.status === 'active' ? 'inactive' : 'active';
      const confirmMsg = next === 'inactive'
        ? 'Xác nhận ngừng kích hoạt tài khoản id=' + id + ' ?'
        : 'Xác nhận kích hoạt lại tài khoản id=' + id + ' ?';
      if(!confirm(confirmMsg)) return;
      item.status = next;
      // cập nhật filtered nếu đang dùng bộ lọc
      filtered = filtered.map(d => d.id === id ? {...d, status: next} : d);
      renderTable();
    }

    // render status as clickable button (toggles both ways)
    function renderStatusBadge(status, id){
      if(status === 'active'){
        return `<button class="status active" onclick="toggleStatus(${id})" title="Click để ngưng">Đang hoạt động</button>`;
      } else {
        return `<button class="status inactive" onclick="toggleStatus(${id})" title="Click để kích hoạt lại">Ngừng hoạt động</button>`;
      }
    }

    function formatDate(d){
      if(!d) return '-';
      return d; // keep YYYY-MM-DD, adjust if needed
    }

    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, function(c){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c];}); }

    // initial render
    renderTable();
  </script>
</body>
</html>
